# Копирование памяти

Когда `PHP` вызывает функцию/Метод `Python`, параметры и возвращаемые значения могут быть объектами копирования памяти, что требует внимания при разработке программ, чувствительных к производительности, поскольку это может увеличить нагрузку на память.

## Параметры

- целые числа, логические значения, числовые типа, пустые значения (`null`) всегда передаются по значению

- Объекты, ресурсы, ссылки всегда передаются по ссылке, и память не копируется
- Строки, массивы будут рекурсивно глубоко скопированы в их первичные типы

```php
$user = PyCore::import("user");
$arg1 = 1234;
$arg2 = 1234.5678;
$arg3 = true;

$arg4 = new PyDict();
$arg5 = new stdClass();
$arg6 = fopen("php://input", "r");

$arg7 = ['hello' => 'world'];
$arg8 = "hello world";
$arg9 = [1, 2, 3, 4, 5];

$user->test($arg1, $arg2, $arg3, $arg4, $arg5, $arg6, $arg7, $arg8, $arg9);
```

- `$arg1`, `$arg2`, `$arg3` будут преобразованы в целые числа, числовые типа, логические значения в `Python` и будут напрямую скопированы

- `$arg4`, `$arg5`, `$arg6` будут переданы в `Python` по ссылке, и не будет发生时 копирования памяти
- `$arg6`, `$arg7`, `$arg8` будут iterated и глубоко скопированы в `Python` как `list`, `dict`, `str`

## Возвращаемые значения

- целые числа, логические значения, числовые типа, пустые значения (`None` и `null`) будут преобразованы в первичные типы `PHP`

- Все остальные результаты возвращенные из `Python` являются типом `PyObject`
- Также можно использовать первичные типы `PHP` (например, `phpy.String` или `phpy.Array`) в `Python` коде для реализации прозрачной передачи

## Избежание копирования памяти
Используйте метод `PyObject::object($value)` для преобразования строк и массивов в `PyObject`. В `Python` коде полученный тип будет `phpy.String` и `phpy.Array`.

Этот подход требует адаптации `Python` кода к системе типов `phpy`.
